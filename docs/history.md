

# History æ¨¡å— API æ–‡æ¡£
## æ¦‚è¿°ï¼ˆHistory æ¨¡å—ï¼‰

History æ¨¡å—ç”¨äºè®°å½•ç”¨æˆ·çš„æµè§ˆè¡Œä¸ºã€‚æ¯å½“ç”¨æˆ·æŸ¥çœ‹ä¸€ä¸ªé¤é¦†çš„è¯¦æƒ…é¡µï¼ˆæˆ–ç‚¹å¼€æ¨èç»“æœï¼‰ï¼Œç³»ç»Ÿå¯ä»¥é€‰æ‹©è°ƒç”¨ History API è®°å½•ä¸€æ¬¡æµè§ˆè¡Œä¸ºã€‚

åŒ…æ‹¬ä»¥ä¸‹èƒ½åŠ›ï¼š

*  æ·»åŠ æµè§ˆè®°å½•
*  è·å–ç”¨æˆ·æµè§ˆå†å²åˆ—è¡¨
*  åˆ é™¤æŒ‡å®šå†å²è®°å½•

History æ¨¡å—çš„æ•°æ®ç»“æ„ä¸ä¼šä¸ä¸šåŠ¡é€»è¾‘å¼ºè€¦åˆï¼Œå‰åç«¯é€šè¿‡ JSON é€šä¿¡ã€‚

---

---

# ğŸ— æ•°æ®ç»“æ„å®šä¹‰ï¼ˆData Contractï¼‰

### User
```json
{
  "user_id": "string"
}
```

> **è¯´æ˜**ï¼šHistory æ¨¡å—åªä¾èµ– user_idï¼›usernameã€å¯†ç ç­‰å­—æ®µä¸å½±å“è¯¥æ¨¡å—ã€‚

---

### History Recordï¼ˆæµè§ˆè®°å½•ï¼‰

åç«¯åœ¨æ‰€æœ‰æ¥å£ä¸­è¿”å›è¯¥ç»“æ„ï¼š

| å­—æ®µ              | ç±»å‹               | è¯´æ˜              |
| --------------- | ---------------- | --------------- |
| id              | integer          | æµè§ˆè®°å½•å”¯ä¸€ ID       |
| user_id         | string           | æ‰€å±ç”¨æˆ·            |
| restaurant_name | string           | é¤é¦†åç§°            |
| timestamp       | string (ISO8601) | æµè§ˆæ—¶é—´ï¼ˆUTC æˆ–å‰ç«¯ä¼ å…¥ï¼‰ |

ç¤ºä¾‹ï¼š

```json
{
  "id": 12,
  "user_id": "test001",
  "restaurant_name": "éº¦å½“åŠ³",
  "timestamp": "2025-11-06T13:00:00"
}
```

---

---

# API è¯¦æƒ…

---

##  æ·»åŠ æµè§ˆè®°å½•ï¼ˆAdd Historyï¼‰

### **POST /users/{user_id}/history**

### â¤ åŠŸèƒ½

ä¸ºæŸä¸ªç”¨æˆ·æ·»åŠ ä¸€æ¡æµè§ˆå†å²ã€‚

### â¤ è¯·æ±‚å‚æ•°ï¼ˆPathï¼‰

| å‚æ•°å     | ç±»å‹     | å¿…å¡« | ç¤ºä¾‹          |
| ------- | ------ | -- | ----------- |
| user_id | string | æ˜¯  | `"test001"` |

---

### â¤ è¯·æ±‚ä½“ï¼ˆJSONï¼‰

```json
{
  "restaurant_name": "éº¦å½“åŠ³",
  "timestamp": "2025-11-06T13:00:00"
}
```

å­—æ®µè¯´æ˜ï¼š

| å­—æ®µ              | å¿…å¡« | ç±»å‹     | è¯´æ˜                     |
| --------------- | -- | ------ | ---------------------- |
| restaurant_name | æ˜¯  | string | é¤é¦†åç§°                   |
| timestamp       | å¦  | string | ISO8601 æ—¶é—´ã€‚ä¸ä¼ åˆ™åç«¯ç”Ÿæˆå½“å‰æ—¶é—´ |

---

### â¤ å“åº”ï¼ˆ201 Createdï¼‰

```json
{
  "message": "History record added successfully"
}
```

---

---

##  æŸ¥è¯¢ç”¨æˆ·å†å²è®°å½•ï¼ˆGet Historyï¼‰

### **GET /users/{user_id}/history**

### â¤ åŠŸèƒ½

æŒ‰æ—¶é—´å€’åºè¿”å›ç”¨æˆ·çš„æ‰€æœ‰æµè§ˆè®°å½•ã€‚

### â¤ è¯·æ±‚å‚æ•°ï¼ˆPathï¼‰

| å‚æ•°å     | ç±»å‹     | å¿…å¡« |
| ------- | ------ | -- |
| user_id | string | æ˜¯  |

---

### â¤ å“åº”ï¼ˆ200 OKï¼‰

```json
[
  {
    "id": 12,
    "user_id": "test001",
    "restaurant_name": "éº¦å½“åŠ³",
    "timestamp": "2025-11-06T13:00:00"
  },
  {
    "id": 11,
    "user_id": "test001",
    "restaurant_name": "è‚¯å¾·åŸº",
    "timestamp": "2025-10-30T19:22:00"
  }
]
```

è¯´æ˜ï¼š

* è¿”å›åˆ—è¡¨æŒ‰ `timestamp` é™åºæ’åˆ—ï¼ˆæœ€è¿‘åœ¨å‰ï¼‰
* å½“ç”¨æˆ·æ— è®°å½•æ—¶è¿”å› `[]`

---

---

##  åˆ é™¤å†å²è®°å½•ï¼ˆDelete Historyï¼‰

### **DELETE /history/{history_id}**

### â¤ åŠŸèƒ½

æ ¹æ® ID åˆ é™¤æŸæ¡å†å²è®°å½•ã€‚

### â¤ è¯·æ±‚å‚æ•°ï¼ˆPathï¼‰

| å‚æ•°å        | ç±»å‹      | å¿…å¡« |
| ---------- | ------- | -- |
| history_id | integer | æ˜¯  |

---

### â¤ å“åº”ï¼ˆ200 OKï¼‰

```json
{
  "message": "History record deleted successfully"
}
```

### â¤ é”™è¯¯ï¼ˆ404 Not Foundï¼‰

```json
{
  "error": "Record not found"
}
```

---

---

# ç¤ºä¾‹ï¼ˆPostmanï¼‰

### POST æ·»åŠ è®°å½•

```
POST http://localhost:5000/users/test001/history
Content-Type: application/json

{
  "restaurant_name": "éº¦å½“åŠ³",
  "timestamp": "2025-11-06T13:00:00"
}
```

### GET æŸ¥è¯¢è®°å½•

```
GET http://localhost:5000/users/test001/history
```

### DELETE åˆ é™¤è®°å½•

```
DELETE http://localhost:5000/history/12
```


